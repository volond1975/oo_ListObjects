# oo_ListObjects
Эмуляция "Умных Таблиц" Excel в SpreadSheetApp

Основное отличие "умных таблиц"(УТ) listobject от NamedRange(ИД)  в том что УТ могут изменять свои размеры ,тоесть расширятся в напрвлении вправо вниз или сужаться в направлении вверх и влево относительно крайней левой верхней ячейки Опорная Ячейка (ОП)
Думаю как то применить метод sheets.spreadsheets.batchUpdate() для того что бы зафиксировать ОП привязкой к ИД

Созданная Таблица получает имя "DataTable_"+нормализированый адресс региона (А1B6). которое, можно изменить на более адекватное на вкладке Данные->Именованые Диапазоны
В раскрывшемся списке стилей выбираем любой вариант заливки на наш вкус и цвет
Созданная один раз Таблица автоматически подстраивается в размерах при добавлении или удалении в нее данных.
В шапке Таблицы автоматически включается Автофильтр (можно принудительно отключить
При добавлении новых строк в них автоматически копируются все формулы.
При создании нового столбца с формулой - она будет автоматически скопирована на весь столбец - не надо тянуть формулу черным крестом автозаполнения.
При прокрутке Таблицы вниз заголовки столбцов (A, B, C…) меняются на названия полей, т.е. уже можно не закреплять шапку диапазона как раньше (в Excel 2010 там еще и автофильтр):
Включив флажок Показать итоговую строку (Total row) на вкладке Конструктор (Design) мы получаем автоматическую строку итогов в конце Таблицы с возможностью выбора функции (сумма, среднее, количество и т.д.) по каждому столбцу:
К данным в Таблице можно адресоваться, используя имена отдельных ее элементов. Например, для суммирования всех чисел в столбце НДС можно воспользоваться формулой =СУММ(Таблица1[НДС]) вместо =СУММ(F2:F200) и не думать уже про размеры таблицы, количество строк и корректность диапазонов выделения. Также возможно использовать еще следующие операторы (предполагается, что таблица имеет стандартное имя Таблица1):
=Таблица1[#Все] - ссылка на всю таблицу, включая заголовки столбцов, данные и строку итого'
=Таблица1[#Данные] - ссылка только на данные (без строки заголовка)
=Таблица1[#Заголовки] - ссылка только на первую строку таблицы с заголовками столбцов
=Таблица1[#Итоги] - ссылка на строку итогов (если она включена)
=Таблица1[#Эта строка] - ссылка на текущую строку, например формула =Таблица1[[#Эта строка];[НДС]] - будет ссылаться на значение НДС из текущей строки таблицы.
